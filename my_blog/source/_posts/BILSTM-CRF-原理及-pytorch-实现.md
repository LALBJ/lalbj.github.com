---
title: BILSTM-CRF 原理及 Pytorch 实现
date: 2023-01-11 19:27:29
tags:
---
## 动态和静态的深度学习工具

动态神经网络工具有 Pytorch 和 Dynet。静态工具包包括 Theano、Keras 和 TensorFlow。他们的核心区别是：
- 在静态工具包中，只需定义一次计算图，编译他，然后将实例传输给它
- 在动态工具包中，需要为每个实例定义一个计算图。它永远不会编译，而是动态执行

如果没有丰富的经验，很难领会到其中的差别。这里我们举一个深度成分分解器的例子，假设我们的模型大致包括下面的步骤：
- 我们自底向上构建树
- 标记根节点（句子中的单词）
- 在此基础上，使用神经网络和单词嵌入来找到构成成分的组合。每当网络形成一个新的组成部分，使用某种方法来得到一个组成部分的嵌入表示。在这种情况下，我们的网络架构将完全依赖于组成部分的嵌入。比如 “the green cat scratch the wall” 这句话中，我们将组合表示为 $(i, j, r) = (1, 3, NP)$（也就是说，一个 $NP$ 成分横跨单词1 到单词 3，也就是本例中的 "the green cat"）

然而，对于另一个句子 “Somewhere, the big fat cat scratched the wall” 。在执行过程中，我们可能会想这样定义成分 $(2, 4, NP)$。成分的定义依赖于实例。在静态工具中通过计算图的一次编译很难或者说基本不可能编程这样的逻辑。然而，在动态工具中并不只有一个预定义的计算图，每一个实例都会有一个新的计算图，所以不存在这个问题。

动态工具的另一个优点是，更容易调试而且更加接近宿主语言（也就是说 Pytorch 和 Dynet 相比 Keras 或者 Theano 更接近 Python 的写法）

## BiLSTM-CRF 决策

在本节中，我们将看到一个用于命名实体识别的 BiLSTM-CRF 复杂示例。